<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>قائمة الطعام</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
</head>
<body>
<h1>قائمة الطعام</h1>

<div id="meals-container"></div>

<script>
// ===== إعداد Firebase =====
const firebaseConfig = {
  apiKey: "API_KEY_HERE",
  authDomain: "PROJECT_ID.firebaseapp.com",
  databaseURL: "https://PROJECT_ID.firebaseio.com",
  projectId: "PROJECT_ID",
  storageBucket: "PROJECT_ID.appspot.com",
  messagingSenderId: "SENDER_ID",
  appId: "APP_ID"
};
firebase.initializeApp(firebaseConfig);

// ===== بيانات المستخدم التجريبية =====
const currentUserUID = "guest_user"; // يمكن تغييره لاحقًا بعد الربط بالدخول

// ===== بيانات الوجبات =====
const meals = [
  { name: "بيتزا", price: 30, img: "pizza.jpg" },
  { name: "برجر", price: 25, img: "burger.jpg" },
  { name: "سلطة", price: 15, img: "salad.jpg" }
];

// ===== عرض الوجبات =====
const container = document.getElementById("meals-container");

meals.forEach(meal => {
  const div = document.createElement("div");
  div.innerHTML = `
    <h3>${meal.name}</h3>
    <img src="${meal.img}" width="150" />
    <p>السعر: ${meal.price}₪</p>
    <button onclick='addToCart("${meal.name}", ${meal.price}, [])'>أضف للسلة</button>
    <hr>
  `;
  container.appendChild(div);
});

// ===== إضافة للسلة =====
function addToCart(name, price, extras) {
  const cartRef = firebase.database().ref("carts/" + currentUserUID);
  const newItemRef = cartRef.push();
  newItemRef.set({
    name,
    price,
    extras,
    timestamp: Date.now(),
    img: meals.find(m => m.name === name)?.img || ''
  }).then(() => {
    alert("✅ تمت الإضافة إلى السلة");
  }).catch(error => {
    console.error("خطأ في إضافة المنتج:", error);
    alert("❌ حدث خطأ أثناء الإضافة");
  });
}
</script>
</body>
</html>
