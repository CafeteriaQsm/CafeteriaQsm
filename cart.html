<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8" />
  <title>Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --primary-color: #c62828;
      --primary-light: #ff5f52;
      --primary-dark: #8e0000;
      --secondary-color: #ffb74d;
      --accent-color: #ff9800;
      --light-bg: #fff8f0;
      --card-bg: #ffffff;
      --text-dark: #3e2723;
      --text-light: #5d4037;
      --shadow: 0 4px 12px rgba(198, 40, 40, 0.15);
      --transition: all 0.3s ease;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      direction: rtl;
      background-color: var(--light-bg);
      color: var(--text-dark);
      line-height: 1.6;
      padding: 20px;
      text-align: right;
    }
    
    .header {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
      color: white;
      padding: 20px;
      border-radius: 16px;
      margin-bottom: 25px;
      box-shadow: var(--shadow);
      text-align: center;
    }
    
    .header h2 {
      font-size: 1.8rem;
      margin-bottom: 10px;
    }
    
    .header p {
      opacity: 0.9;
    }
    
    .cart-container {
      max-width: 800px;
      margin: 0 auto;
    }
    
    .empty-cart {
      background-color: var(--card-bg);
      border-radius: 16px;
      padding: 40px 20px;
      text-align: center;
      box-shadow: var(--shadow);
      margin-bottom: 20px;
    }
    
    .empty-cart i {
      font-size: 4rem;
      color: var(--primary-light);
      margin-bottom: 20px;
    }
    
    .empty-cart h3 {
      color: var(--text-dark);
      margin-bottom: 10px;
    }
    
    .empty-cart p {
      color: var(--text-light);
      margin-bottom: 20px;
    }
    
    .order-card {
      background-color: var(--card-bg);
      border-radius: 16px;
      margin-bottom: 20px;
      padding: 20px;
      box-shadow: var(--shadow);
      display: flex;
      gap: 15px;
      align-items: center;
      transition: var(--transition);
    }
    
    .order-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 16px rgba(198, 40, 40, 0.2);
    }
    
    .order-card img {
      width: 80px;
      height: 80px;
      border-radius: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }
    
    .order-details {
      flex-grow: 1;
    }
    
    .order-details h3 {
      color: var(--text-dark);
      margin-bottom: 8px;
      font-size: 1.2rem;
    }
    
    .order-details p {
      color: var(--text-light);
      margin-bottom: 5px;
    }
    
    .price {
      color: var(--primary-color);
      font-weight: bold;
      font-size: 1.1rem;
    }
    
    .extras {
      color: var(--text-light);
      font-size: 0.9rem;
      margin-top: 5px;
    }
    
    .remove-btn {
      background-color: #f8d7da;
      color: #721c24;
      border: none;
      padding: 8px 15px;
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 0.9rem;
    }
    
    .remove-btn:hover {
      background-color: #f1b0b7;
    }
    
    .total-section {
      background-color: var(--card-bg);
      border-radius: 16px;
      padding: 20px;
      margin: 25px 0;
      box-shadow: var(--shadow);
      text-align: center;
    }
    
    .total-section h3 {
      color: var(--text-dark);
      margin-bottom: 10px;
      font-size: 1.3rem;
    }
    
    .total-price {
      color: var(--primary-color);
      font-weight: bold;
      font-size: 1.8rem;
      margin: 10px 0;
    }
    
    .order-form {
      background-color: var(--card-bg);
      border-radius: 16px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: var(--shadow);
    }
    
    .order-form h3 {
      color: var(--primary-color);
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px dashed var(--secondary-color);
      text-align: center;
    }
    
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-group label {
      display: block;
      margin-bottom: 8px;
      color: var(--text-dark);
      font-weight: 600;
    }
    
    .form-group input, .form-group select, .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 10px;
      font-size: 1rem;
      transition: var(--transition);
    }
    
    .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
      border-color: var(--primary-color);
      outline: none;
      box-shadow: 0 0 0 3px rgba(198, 40, 40, 0.1);
    }
    
    .payment-methods {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 10px;
      margin-top: 10px;
    }
    
    .payment-method {
      border: 2px solid #ddd;
      border-radius: 10px;
      padding: 12px;
      text-align: center;
      cursor: pointer;
      transition: var(--transition);
    }
    
    .payment-method:hover {
      border-color: var(--primary-light);
    }
    
    .payment-method.selected {
      border-color: var(--primary-color);
      background-color: rgba(198, 40, 40, 0.05);
    }
    
    .payment-method i {
      font-size: 1.5rem;
      margin-bottom: 8px;
      color: var(--primary-color);
    }
    
    .payment-method span {
      display: block;
      font-size: 0.9rem;
      color: var(--text-dark);
    }
    
    .action-buttons {
      display: flex;
      gap: 15px;
      margin-top: 30px;
      flex-wrap: wrap;
    }
    
    .btn {
      padding: 14px 25px;
      border: none;
      border-radius: 50px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      flex: 1;
      min-width: 150px;
    }
    
    .btn-primary {
      background: linear-gradient(to right, var(--primary-color), var(--primary-light));
      color: white;
    }
    
    .btn-primary:hover {
      background: linear-gradient(to right, var(--primary-dark), var(--primary-color));
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(198, 40, 40, 0.2);
    }
    
    .btn-secondary {
      background-color: #e9ecef;
      color: var(--text-dark);
    }
    
    .btn-secondary:hover {
      background-color: #dee2e6;
      transform: translateY(-3px);
    }
    
    .btn-outline {
      background-color: transparent;
      border: 2px solid var(--primary-color);
      color: var(--primary-color);
    }
    
    .btn-outline:hover {
      background-color: var(--primary-color);
      color: white;
      transform: translateY(-3px);
    }
    
    .status-view {
      background-color: var(--card-bg);
      border-radius: 16px;
      padding: 25px;
      margin: 25px 0;
      box-shadow: var(--shadow);
      text-align: center;
    }
    
    .status-view h3 {
      color: var(--primary-color);
      margin-bottom: 15px;
    }
    
    .status-info {
      background-color: #e7f3ff;
      border-radius: 12px;
      padding: 15px;
      margin: 15px 0;
    }
    
    .status-info p {
      margin-bottom: 10px;
    }
    
    .my-orders-section {
      margin-top: 40px;
    }
    
    .my-orders-section h3 {
      color: var(--primary-color);
      margin-bottom: 20px;
      text-align: center;
      padding-bottom: 10px;
      border-bottom: 2px dashed var(--secondary-color);
    }
    
    .orders-container {
      max-height: 500px;
      overflow-y: auto;
      padding: 10px;
    }
    
    .order-item-list {
      margin-top: 15px;
      padding-right: 15px;
    }
    
    .order-item-list li {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
      padding-bottom: 10px;
      border-bottom: 1px dashed #eee;
    }
    
    .order-item-list img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      object-fit: cover;
    }
    
    .order-status {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    .status-pending {
      background-color: #fff3cd;
      color: #856404;
    }
    
    .status-processing {
      background-color: #cce7ff;
      color: #004085;
    }
    
    .status-ready {
      background-color: #d1edff;
      color: #0c5460;
    }
    
    .status-completed {
      background-color: #d4edda;
      color: #155724;
    }
    
    @media (max-width: 768px) {
      .order-card {
        flex-direction: column;
        text-align: center;
      }
      
      .action-buttons {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
      
      .payment-methods {
        grid-template-columns: 1fr 1fr;
      }
    }
    
    @media (max-width: 480px) {
      .header h2 {
        font-size: 1.5rem;
      }
      
      .payment-methods {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>

<div class="header">
  <h2><i class="fas fa-shopping-cart"></i> Ø³Ù„Ø© Ø§Ù„Ø·Ù„Ø¨Ø§Øª</h2>
  <p>Ø±Ø§Ø¬Ø¹ Ø·Ù„Ø¨Ø§ØªÙƒ ÙˆØ£ÙƒÙ…Ù„ Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡</p>
</div>

<div class="cart-container">
  <div id="cartContainer"></div>
  
  <div class="order-form" id="orderSummary" style="display:none;">
    <h3><i class="fas fa-user-edit"></i> Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ø·Ù„Ø¨</h3>
    
    <div class="form-group">
      <label for="studentName"><i class="fas fa-user"></i> Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨</label>
      <input type="text" id="studentName" required placeholder="Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ùƒ Ø§Ù„ÙƒØ§Ù…Ù„">
    </div>
    
    <div class="form-group">
      <label for="pickupInput"><i class="fas fa-clock"></i> ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label>
      <input type="time" id="pickupInput">
    </div>
    
    <div class="form-group">
      <label><i class="fas fa-credit-card"></i> Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
      <div class="payment-methods">
        <div class="payment-method" onclick="selectPaymentMethod('cash')">
          <i class="fas fa-money-bill-wave"></i>
          <span>Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹</span>
        </div>
        <div class="payment-method" onclick="selectPaymentMethod('card')">
          <i class="fas fa-credit-card"></i>
          <span>Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†</span>
        </div>
        <div class="payment-method" onclick="selectPaymentMethod('mobile')">
          <i class="fas fa-mobile-alt"></i>
          <span>Ù…Ø­ÙØ¸Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©</span>
        </div>
      </div>
    </div>
    
    <div class="form-group">
      <label for="noteInput"><i class="fas fa-sticky-note"></i> Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ©</label>
      <textarea id="noteInput" rows="3" placeholder="Ø£Ø¯Ø®Ù„ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø·Ù„Ø¨ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)"></textarea>
    </div>
    
    <div class="action-buttons">
      <button class="btn btn-secondary" onclick="goToMenu()">
        <i class="fas fa-arrow-right"></i> Ø§Ù„Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù‚Ø§Ø¦Ù…Ø©
      </button>
      <button class="btn btn-primary" onclick="confirmOrder()">
        <i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
      </button>
    </div>
  </div>
  
  <div id="statusView"></div>
  
  <div class="my-orders-section">
    <h3><i class="fas fa-clipboard-list"></i> Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠØ©</h3>
    <button class="btn btn-outline" onclick="showMyOrders()">
      <i class="fas fa-eye"></i> Ø¹Ø±Ø¶ Ø·Ù„Ø¨Ø§ØªÙŠ
    </button>
    <div id="myOrdersContainer" class="orders-container"></div>
  </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
<script>
const firebaseConfig = {
  apiKey: "AIzaSyCu4ged4p8GzaQo4DFbY_sthYWHSvSYqpU",
  authDomain: "cafeteria-students-app.firebaseapp.com",
  databaseURL: "https://cafeteria-students-app-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "cafeteria-students-app",
  storageBucket: "cafeteria-students-app.appspot.com",
  messagingSenderId: "338557210649",
  appId: "1:338557210649:web:ba36c4623b4677ca585a88"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

const cartContainer = document.getElementById("cartContainer");
const orderSummary = document.getElementById("orderSummary");
const myOrdersContainer = document.getElementById("myOrdersContainer");
const order = JSON.parse(localStorage.getItem("order")) || { cart: [] };
const userId = localStorage.getItem("userUID") || "user_" + Math.floor(Math.random() * 10000);
let selectedPaymentMethod = "cash";

// âœ… Ø¹Ø±Ø¶ Ù…Ø­ØªÙˆÙŠØ§Øª Ø§Ù„Ø³Ù„Ø©
if (order.cart.length > 0) {
  let total = 0;
  order.cart.forEach((item, i) => {
    total += item.price;
    const div = document.createElement("div");
    div.className = "order-card";
    div.innerHTML = `
      <img src="${item.img}" alt="${item.name}">
      <div class="order-details">
        <h3>${item.name}</h3>
        <p class="price">â‚ª${item.price}</p>
        ${item.extras?.length ? `<p class="extras"><strong>Ø§Ù„Ø¥Ø¶Ø§ÙØ§Øª:</strong> ${item.extras.join(", ")}</p>` : ""}
      </div>
      <button class="remove-btn" onclick="removeItem(${i})">
        <i class="fas fa-trash"></i> Ø¥Ø²Ø§Ù„Ø©
      </button>
    `;
    cartContainer.appendChild(div);
  });
  
  const totalSection = document.createElement("div");
  totalSection.className = "total-section";
  totalSection.innerHTML = `
    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø·Ù„Ø¨</h3>
    <div class="total-price">â‚ª${total}</div>
    <p>ÙŠØ´Ù…Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø¥Ø¶Ø§ÙØ§Øª</p>
  `;
  cartContainer.appendChild(totalSection);

  orderSummary.style.display = "block";
} else {
  cartContainer.innerHTML = `
    <div class="empty-cart">
      <i class="fas fa-shopping-cart"></i>
      <h3>Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ ÙØ§Ø±ØºØ©</h3>
      <p>Ù„Ù… ØªÙ‚Ù… Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙŠ Ø¹Ù†Ø§ØµØ± Ø¥Ù„Ù‰ Ø³Ù„Ø© Ø§Ù„ØªØ³ÙˆÙ‚ Ø¨Ø¹Ø¯</p>
      <button class="btn btn-primary" onclick="goToMenu()">
        <i class="fas fa-utensils"></i> ØªØµÙØ­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
      </button>
    </div>
  `;
}

function removeItem(index) {
  order.cart.splice(index, 1);
  localStorage.setItem("order", JSON.stringify(order));
  location.reload();
}

function selectPaymentMethod(method) {
  selectedPaymentMethod = method;
  
  // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
  document.querySelectorAll('.payment-method').forEach(btn => {
    btn.classList.remove('selected');
  });
  
  // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ­Ø¯ÙŠØ¯ Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø®ØªØ§Ø±
  event.currentTarget.classList.add('selected');
}

function goToMenu() {
  window.location.href = "menu.html";
}

// âœ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¥Ù„Ù‰ Firebase
function confirmOrder() {
  const timeValue = document.getElementById("pickupInput").value;
  const nameValue = document.getElementById("studentName").value.trim();
  const note = document.getElementById("noteInput").value.trim();

  if (!timeValue || !nameValue) {
    showNotification("âš ï¸ Ø§Ù„Ø±Ø¬Ø§Ø¡ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©", "error");
    return;
  }

  const orderCode = Math.floor(100000 + Math.random() * 900000);

  const newOrder = {
    code: orderCode,
    studentName: nameValue,
    userId: userId,
    items: order.cart,
    pickupTime: timeValue,
    paymentMethod: selectedPaymentMethod,
    notes: note,
    total: order.cart.reduce((sum, item) => sum + item.price, 0),
    status: "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©",
    timestamp: new Date().toISOString()
  };

  firebase.database().ref("orders").push(newOrder).then(() => {
    localStorage.removeItem("order");
    showStatusTracking(newOrder);
    showNotification("âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­!", "success");
  }).catch(error => {
    showNotification("âŒ Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨", "error");
    console.error("Error:", error);
  });
}

// âœ… ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
function showStatusTracking(data) {
  const statusView = document.getElementById("statusView");
  statusView.innerHTML = `
    <div class="status-view">
      <h3><i class="fas fa-check-circle"></i> ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨Ùƒ</h3>
      <div class="status-info">
        <p><strong>Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨:</strong> ${data.code}</p>
        <p><strong>Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©:</strong> <span class="order-status status-pending" id="liveStatus">${data.status}</span></p>
        <p><strong>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> ${getPaymentMethodText(data.paymentMethod)}</p>
        <p><strong>ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</strong> ${data.pickupTime}</p>
      </div>
      <p>Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹. ÙŠÙ…ÙƒÙ†Ùƒ Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø·Ù„Ø¨ Ù…Ù† Ù‚Ø³Ù… "Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ø­Ø§Ù„ÙŠØ©"</p>
    </div>
  `;
  trackLiveStatus(data.code);
  document.getElementById("orderSummary").style.display = "none";
  cartContainer.innerHTML = "";
}

function getPaymentMethodText(method) {
  const methods = {
    'cash': 'Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹',
    'card': 'Ø¨Ø·Ø§Ù‚Ø© Ø§Ø¦ØªÙ…Ø§Ù†',
    'mobile': 'Ù…Ø­ÙØ¸Ø© Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©'
  };
  return methods[method] || method;
}

// âœ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø­Ø§Ù„Ø© Ù„Ø­Ø¸ÙŠØ§Ù‹
function trackLiveStatus(code) {
  db.ref("orders").orderByChild("code").equalTo(code).on("value", snapshot => {
    snapshot.forEach(child => {
      const newStatus = child.val().status;
      document.getElementById("liveStatus").innerText = newStatus;
      
      // ØªØ­Ø¯ÙŠØ« ÙØ¦Ø© Ø§Ù„Ø­Ø§Ù„Ø© Ø­Ø³Ø¨ Ø§Ù„ØªÙ‚Ø¯Ù…
      const statusElement = document.getElementById("liveStatus");
      statusElement.className = "order-status";
      
      if (newStatus === "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©") {
        statusElement.classList.add("status-pending");
      } else if (newStatus === "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±") {
        statusElement.classList.add("status-processing");
      } else if (newStatus === "Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…") {
        statusElement.classList.add("status-ready");
      } else if (newStatus === "Ù…ÙƒØªÙ…Ù„") {
        statusElement.classList.add("status-completed");
      }
    });
  });
}

// âœ… Ø¹Ø±Ø¶ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø­Ø§Ù„ÙŠ ÙÙ‚Ø·
function showMyOrders() {
  myOrdersContainer.innerHTML = "<p>ğŸ”„ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø·Ù„Ø¨Ø§ØªÙƒ...</p>";
  db.ref("orders").orderByChild("userId").equalTo(userId).on("value", snapshot => {
    myOrdersContainer.innerHTML = "";
    let found = false;

    snapshot.forEach(child => {
      const order = child.val();
      const listItems = order.items?.map(item =>
        `<li>
          <img src="${item.img}">
          <div>
            <strong>${item.name}</strong> - â‚ª${item.price}
            ${item.extras?.length ? `<br><small>${item.extras.join(", ")}</small>` : ""}
          </div>
        </li>`
      ).join("");

      found = true;
      const card = document.createElement("div");
      card.className = "order-card";
      
      // ØªØ­Ø¯ÙŠØ¯ ÙØ¦Ø© Ø§Ù„Ø­Ø§Ù„Ø©
      let statusClass = "status-pending";
      if (order.status === "Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ø¶ÙŠØ±") statusClass = "status-processing";
      else if (order.status === "Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªÙ„Ø§Ù…") statusClass = "status-ready";
      else if (order.status === "Ù…ÙƒØªÙ…Ù„") statusClass = "status-completed";
      
      card.innerHTML = `
        <div style="width: 100%;">
          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3>ğŸ§¾ Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨: ${order.code}</h3>
            <span class="order-status ${statusClass}">${order.status}</span>
          </div>
          <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
            <p><strong>ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨:</strong> ${order.studentName}</p>
            <p><strong>â° ÙˆÙ‚Øª Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…:</strong> ${order.pickupTime}</p>
            <p><strong>ğŸ’° Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹:</strong> â‚ª${order.total}</p>
            <p><strong>ğŸ’³ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹:</strong> ${getPaymentMethodText(order.paymentMethod)}</p>
          </div>
          ${order.notes ? `<p><strong>ğŸ“ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª:</strong> ${order.notes}</p>` : ""}
          <div class="order-item-list">
            <h4>Ø§Ù„Ø·Ù„Ø¨Ø§Øª:</h4>
            <ul>${listItems}</ul>
          </div>
        </div>
      `;
      myOrdersContainer.appendChild(card);
    });

    if (!found) {
      myOrdersContainer.innerHTML = "<p>âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø­Ø§Ù„ÙŠØ©.</p>";
    }
  });
}

// Ø¥Ø¸Ù‡Ø§Ø± Ø¥Ø´Ø¹Ø§Ø±
function showNotification(message, type) {
  const notification = document.createElement('div');
  notification.textContent = message;
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: ${type === 'error' ? '#f8d7da' : '#d4edda'};
    color: ${type === 'error' ? '#721c24' : '#155724'};
    padding: 15px 25px;
    border-radius: 50px;
    box-shadow: var(--shadow);
    z-index: 10000;
    font-weight: bold;
    animation: fadeInOut 3s ease;
    border: 1px solid ${type === 'error' ? '#f5c6cb' : '#c3e6cb'};
  `;
  
  document.body.appendChild(notification);
  
  setTimeout(() => {
    notification.remove();
  }, 3000);
}

// ØªØ­Ø¯ÙŠØ¯ Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
document.addEventListener('DOMContentLoaded', function() {
  // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¯ÙØ¹ Ù†Ù‚Ø¯Ø§Ù‹ ÙƒØ®ÙŠØ§Ø± Ø§ÙØªØ±Ø§Ø¶ÙŠ
  document.querySelector('.payment-method').classList.add('selected');
});
</script>
</body>
</html>
